# Delete Binaries Deleted

PostgreSQLã®`Binaries_deleted`ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å…¨ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

## ç‰¹å¾´

- ğŸ”„ **ãƒãƒƒãƒå‡¦ç†**: 400ãƒ¬ã‚³ãƒ¼ãƒ‰ãšã¤å®‰å…¨ã«å‰Šé™¤
- ğŸ›¡ï¸ **å®‰å…¨æ€§**: å‰Šé™¤å‰ã®ç¢ºèªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¨ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ‰
- ğŸ“Š **é€²æ—è¡¨ç¤º**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®å‰Šé™¤é€²æ—ã¨çµ±è¨ˆæƒ…å ±
- ğŸ” **ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³**: å®Ÿéš›ã®å‰Šé™¤å‰ã«å½±éŸ¿ã‚’ç¢ºèª
- ğŸ“ **è©³ç´°ãƒ­ã‚°**: æ“ä½œã®è©³ç´°ãªè¨˜éŒ²
- âš¡ **é«˜é€Ÿå‡¦ç†**: åŠ¹ç‡çš„ãªãƒãƒƒãƒå‰Šé™¤

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### uvã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ³/ç§»å‹•
cd delete-binaries-deleted

# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
uv sync

# é–‹ç™ºä¾å­˜é–¢ä¿‚ã‚‚å«ã‚ã‚‹å ´åˆ
uv sync --extra dev
```

## è¨­å®š

`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ãã ã•ã„ï¼š

```env
DB_HOST=your-postgres-host
DB_PORT=5432
DB_NAME=your-database-name
DB_USER=your-username
DB_PASSWORD=your-password
```

âš ï¸ **é‡è¦**: `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã¯`.gitignore`ã«å«ã¾ã‚Œã¦ã„ã‚‹ãŸã‚ã€Gitã«ã‚³ãƒŸãƒƒãƒˆã•ã‚Œã¾ã›ã‚“ã€‚

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬çš„ãªä½¿ç”¨

```bash
# uvã®ä»®æƒ³ç’°å¢ƒã§å®Ÿè¡Œ
uv run delete-binaries

# ã¾ãŸã¯ä»®æƒ³ç’°å¢ƒã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆã—ã¦å®Ÿè¡Œ
uv shell
delete-binaries
```

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³

```bash
# ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ï¼ˆå®Ÿéš›ã«ã¯å‰Šé™¤ã—ãªã„ï¼‰
uv run delete-binaries --dry-run

# ãƒãƒƒãƒã‚µã‚¤ã‚ºã‚’å¤‰æ›´
uv run delete-binaries --batch-size 200

# ç¢ºèªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—
uv run delete-binaries --force

# è©³ç´°ãƒ­ã‚°ã‚’æœ‰åŠ¹åŒ–
uv run delete-binaries --verbose

# å…¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®çµ„ã¿åˆã‚ã›
uv run delete-binaries --batch-size 500 --verbose --force
```

### ãƒ˜ãƒ«ãƒ—

```bash
uv run delete-binaries --help
```

## å®‰å…¨æ©Ÿèƒ½

1. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã®æ¤œè¨¼**: å®Ÿè¡Œå‰ã«æ¥ç¶šã‚’ãƒ†ã‚¹ãƒˆ
2. **å‰Šé™¤å‰ç¢ºèª**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å‰Šé™¤å‰ã«ç¢ºèªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
3. **ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ‰**: `--dry-run`ã§å‰Šé™¤å†…å®¹ã‚’äº‹å‰ç¢ºèª
4. **ãƒãƒƒãƒå‡¦ç†**: ãƒ¡ãƒ¢ãƒªåŠ¹ç‡çš„ãª400ä»¶ãšã¤ã®å‡¦ç†
5. **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†**: ã‚¨ãƒ©ãƒ¼æ™‚ã®è‡ªå‹•ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
6. **è©³ç´°ãƒ­ã‚°**: å…¨æ“ä½œã®è¨˜éŒ²

## å‡ºåŠ›ä¾‹

```
Delete Binaries Deleted Tool
Safely delete all records from Binaries_deleted table

ğŸ” Validating database connection...
âœ… Database connection validated

ğŸ“Š Analyzing data...
                     Deletion Statistics
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Metric            â”ƒ Value                                           â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ Total Records     â”‚ 1,500                                           â”‚
â”‚ Batch Size        â”‚ 400                                             â”‚
â”‚ Estimated Batches â”‚ 4                                               â”‚
â”‚ Estimated Time    â”‚ 0.4 minutes                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸  WARNING: This will permanently delete ALL records from Binaries_deleted table!
Are you sure you want to delete 1,500 records? [y/N]:
```

## é–‹ç™º

### é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# é–‹ç™ºä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
uv sync --extra dev

# pre-commitãƒ•ãƒƒã‚¯ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
uv run pre-commit install
```

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
uv run pytest

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ããƒ†ã‚¹ãƒˆ
uv run pytest --cov=delete_binaries_deleted
```

### ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯

```bash
# ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
uv run black src/ tests/

# ãƒªãƒ³ãƒˆ
uv run flake8 src/ tests/

# å‹ãƒã‚§ãƒƒã‚¯
uv run mypy src/
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

1. `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®šã‚’ç¢ºèª
2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒãƒ¼ãŒç¨¼åƒä¸­ã‹ç¢ºèª
3. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèª
4. èªè¨¼æƒ…å ±ãŒæ­£ã—ã„ã‹ç¢ºèª

### ãƒ¡ãƒ¢ãƒªä¸è¶³

ãƒãƒƒãƒã‚µã‚¤ã‚ºã‚’å°ã•ãã—ã¦ãã ã•ã„ï¼š

```bash
uv run delete-binaries --batch-size 100
```

### æ¨©é™ã‚¨ãƒ©ãƒ¼

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«`DELETE`æ¨©é™ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

## æ³¨æ„äº‹é …

âš ï¸ **ã“ã®ãƒ„ãƒ¼ãƒ«ã¯æ°¸ç¶šçš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã€‚**
